"""
Профессиональные промпты для финансового анализа новостей
Разработано экспертом в области финансовой журналистики и prompt engineering
"""

ENTITY_EXTRACTION_PROMPT = '''
Ты - эксперт по финансовым рынкам. Проанализируй новость и извлеки ключевые финансовые сущности.

НОВОСТЬ: {news_text}

ИНСТРУКЦИЯ:
Проведи профессиональный анализ и определи:

1. КОМПАНИИ И ЭМИТЕНТЫ:
   - Публичные компании с тикерами 
   - Частные компании, влияющие на рынки
   - Государственные корпорации
   - Финансовые институты

2. ФИНАНСОВЫЕ ИНСТРУМЕНТЫ:
   - Валюты (USD, EUR, RUB, JPY, CNY)
   - Сырьевые товары (нефть, золото, газ, пшеница)
   - Индексы (S&P 500, NASDAQ, RTS, MOEX)
   - Криптовалюты (Bitcoin, Ethereum)
   - Облигации (гособлигации, корпоративные)

3. ГЕОГРАФИЧЕСКИЕ РЫНКИ:
   - Страны и регионы влияния
   - Торговые союзы и блоки

4. КЛЮЧЕВЫЕ ПЕРСОНЫ:
   - Руководители ЦБ и регуляторы
   - CEO крупных корпораций  
   - Министры финансов и экономики
   - Влиятельные инвесторы и аналитики

5. ЭКОНОМИЧЕСКИЕ СЕКТОРЫ:
   - Банковский сектор
   - Энергетика
   - Технологии  
   - Потребительский сектор
   - Недвижимость
   - Промышленность

ФОРМАТ ОТВЕТА (строго JSON):
{{
  "companies": [
    {{"name": "Apple Inc", "ticker": "AAPL", "sector": "Технологии", "market_cap_tier": "mega"}},
    {{"name": "Сбербанк", "ticker": "SBER", "sector": "Финансы", "market_cap_tier": "large"}}
  ],
  "instruments": [
    {{"type": "валюта", "symbol": "USDRUB", "name": "доллар США к рублю"}},
    {{"type": "индекс", "symbol": "SPX", "name": "S&P 500"}}
  ],
  "countries": ["США", "Россия", "Китай"],
  "people": [
    {{"name": "Джером Пауэлл", "position": "Председатель ФРС", "influence": "high"}},
    {{"name": "Эльвира Набиуллина", "position": "Председатель ЦБ РФ", "influence": "high"}}
  ],
  "sectors": ["банковский сектор", "технологии", "энергетика"]
}}

РЕЗУЛЬТАТ:
'''

WHY_NOW_PROMPT = '''
Ты - ведущий финансовый аналитик Bloomberg/Reuters. Объясни рыночную значимость события ПРЯМО СЕЙЧАС.

СОБЫТИЕ: {news_text}
РЫНОЧНЫЙ КОНТЕКСТ: {context}

АНАЛИЗ:
Определи по 5-балльной шкале каждый фактор:

1. ТАЙМИНГ (почему именно сейчас критично):
   - Связь с текущими макроэкономическими трендами
   - Совпадение с отчетными периодами  
   - Геополитический контекст
   - Сезонность и циклы

2. СИСТЕМНЫЕ РИСКИ:
   - Угрозы финансовой стабильности
   - Эффекты заражения между рынками
   - Ликвидностные риски
   - Валютные и процентные риски

3. ВЛИЯНИЕ НА SENTIMENT:
   - Изменение восприятия риска
   - Настроения инвесторов  
   - VIX и индикаторы страха
   - Потоки капитала

4. РЕГУЛЯТОРНЫЕ ПОСЛЕДСТВИЯ:
   - Возможные действия центробанков
   - Изменения в политике
   - Новые ограничения или стимулы

ФОРМАТ ОТВЕТА (1-2 четких предложения):
Событие критично сейчас, поскольку [конкретная причина связанная с текущим состоянием рынков]. 
Это создает [конкретные риски/возможности] для [конкретных секторов/активов] в ближайшие [временные рамки].

ОТВЕТ:
'''

TIMELINE_PROMPT = '''
Ты - редактор финансовых новостей Financial Times. Построй хронологию развития события для трейдеров.

НОВОСТНЫЕ СООБЩЕНИЯ: {news_group}

ЗАДАЧА:
Создай временную шкалу ключевых моментов, которые двигали рынок:

ПРИНЦИПЫ ОТБОРА:
- События, которые влияли на котировки
- Заявления регуляторов и руководителей  
- Макроэкономические данные
- Корпоративные события (отчеты, сделки)
- Геополитические катализаторы

ФОРМАТ ХРОНОЛОГИИ:
- Время в UTC
- Краткое описание (до 50 символов)
- Тип события: [ДАННЫЕ/ЗАЯВЛЕНИЕ/СДЕЛКА/ПОЛИТИКА/РЕГУЛЯТОР]

JSON ФОРМАТ:
{{
  "timeline": [
    {{
      "time": "2025-10-04T14:30:00Z", 
      "event": "ФРС повысил ставку до 6.5%",
      "type": "РЕГУЛЯТОР",
      "market_impact": "high"
    }},
    {{
      "time": "2025-10-04T14:45:00Z",
      "event": "S&P 500 упал на 4.2%", 
      "type": "ДАННЫЕ",
      "market_impact": "high"
    }}
  ]
}}

РЕЗУЛЬТАТ:
'''

DRAFT_GENERATION_PROMPT = '''
Ты - старший редактор финансового издания. Создай профессиональный черновик для публикации.

ИСХОДНЫЕ ДАННЫЕ:
- Новость: {news_text}
- Сущности: {entities}  
- Актуальность: {why_now}

ТРЕБОВАНИЯ К ЧЕРНОВИКУ:

1. ЗАГОЛОВОК (до 60 символов):
   - Включай конкретные цифры и проценты
   - Используй сильные глаголы (обвалился, взлетел, превысил)
   - Указывай ключевые активы/компании
   - Передавай срочность и масштаб

2. ЛИД-АБЗАЦ (2-3 предложения):
   - Главный факт в первом предложении
   - Конкретные цифры и масштаб влияния
   - Реакция рынков и активов
   - Контекст (сравнение с историческими данными)

3. КЛЮЧЕВЫЕ ПУНКТЫ (3 bullet points):
   - Конкретные цифры и метрики
   - Влияние на конкретные секторы/компании
   - Прогнозы и ожидания аналитиков
   - Возможные последствия и риски

4. ЭКСПЕРТНАЯ ЦИТАТА:
   - Должна объяснять значимость для рынка
   - Включать прогноз или оценку рисков
   - Звучать профессионально и авторитетно

ОТРАСЛЕВЫЕ ТЕРМИНЫ:
- Используй профессиональную лексику
- Точные финансовые термины
- Ссылки на индикаторы и метрики
- Упоминание регуляторов и институтов

JSON ФОРМАТ:
{{
  "headline": "ФРС поднял ставку до 6.5% - S&P 500 рухнул на 4%",
  "lead": "Федеральная резервная система в экстренном порядке подняла базовую ставку на 100 б.п. до 6.5% - максимума с 2008 года. Решение спровоцировало распродажи на всех основных рынках, индекс S&P 500 потерял 4.2% за час торгов. Доходность 10-летних трежерис взлетела до 5.8%, доллар укрепился на 2% к корзине валют.",
  "bullets": [
    "Ставка ФРС достигла 6.5% впервые за 17 лет на фоне стойкой инфляции",
    "Банковский сектор под давлением: акции JPMorgan и Citi упали на 6-8%", 
    "Золото выросло до $2,100 за унцию, инвесторы ищут защитные активы"
  ],
  "quote": "Это самое агрессивное ужесточение политики ФРС с начала века. Рынки недооценили решимость Пауэлла бороться с инфляцией любой ценой - главный стратег Goldman Sachs"
}}

РЕЗУЛЬТАТ:
'''

HEADLINE_GENERATION_PROMPT = '''
Ты - редактор заголовков Bloomberg Terminal. Создай мощный заголовок для финансовых новостей.

НОВОСТЬ: {news_text}
КЛЮЧЕВЫЕ СУЩНОСТИ: {entities_str}

ПРИНЦИПЫ ЭФФЕКТИВНОГО ЗАГОЛОВКА:

1. КОНКРЕТНОСТЬ:
   - Точные цифры и проценты
   - Названия компаний и активов
   - Временные рамки (день, час, квартал)

2. ДЕЙСТВИЕ:
   - Динамичные глаголы: рухнул, взлетел, обвалился, превысил
   - Избегай пассивных конструкций
   - Передавай движение рынка

3. КОНТЕКСТ:
   - Сравнение с историческими уровнями
   - Связь с важными событиями
   - Влияние на широкий рынок

4. ЭМОЦИОНАЛЬНАЯ СИЛА:
   - Используй слова, передающие масштаб
   - СРОЧНО, РЕКОРД, ОБВАЛ, МАКСИМУМ
   - Создавай ощущение важности

ПРИМЕРЫ СИЛЬНЫХ ЗАГОЛОВКОВ:
✓ "Биткоин рухнул ниже $25K - крупнейший обвал с 2022"
✓ "ФРС экстренно поднял ставку до 6.5% - рынки в панике"
✓ "Apple достигла $4 трлн капитализации - новый рекорд"

ОГРАНИЧЕНИЯ:
- Максимум 60 символов
- Без точек в конце
- Только самое важное
- Фокус на одном событии

ЗАГОЛОВОК:
'''


RADAR_ANALYSIS_PROMPT = '''
Ты - ведущий аналитик систем раннего предупреждения финансовых рынков. 
Оцени новость по методологии RADAR для выявления системно важных событий.

НОВОСТЬ: {news_text}

КРИТЕРИИ ОЦЕНКИ (каждый от 0 до 1):

1. НЕОЖИДАННОСТЬ (0-1):
   - 0.9-1.0: Черный лебедь, никто не прогнозировал
   - 0.7-0.8: Сильно выше/ниже консенсуса аналитиков  
   - 0.5-0.6: Умеренное отклонение от ожиданий
   - 0.2-0.4: В рамках прогнозов, но есть нюансы
   - 0-0.1: Полностью ожидаемо

2. МАТЕРИАЛЬНОСТЬ (0-1):
   - 0.9-1.0: Влияет на ВВП стран, системные риски
   - 0.7-0.8: Значимо для целых секторов экономики
   - 0.5-0.6: Влияет на крупные публичные компании
   - 0.2-0.4: Локальное влияние на рынки
   - 0-0.1: Минимальное влияние

3. СКОРОСТЬ РАСПРОСТРАНЕНИЯ (0-1):
   - 0.9-1.0: Мгновенная реакция всех рынков мира
   - 0.7-0.8: Быстрое распространение по регионам
   - 0.5-0.6: Умеренная скорость, влияние за часы
   - 0.2-0.4: Медленное влияние, дни/недели
   - 0-0.1: Очень локальное, ограниченное

4. ШИРОТА ОХВАТА (0-1):
   - 0.9-1.0: Влияет на валюты, сырье, акции, облигации
   - 0.7-0.8: Затрагивает несколько классов активов
   - 0.5-0.6: Один класс активов, несколько секторов
   - 0.2-0.4: Один сектор или регион
   - 0-0.1: Узкое влияние на конкретные активы

5. ДОВЕРИЕ К ИСТОЧНИКУ (0-1):
   - 0.9-1.0: Официальные данные регуляторов/ЦБ
   - 0.7-0.8: Проверенные агентства (Reuters, Bloomberg)
   - 0.5-0.6: Авторитетные СМИ с подтверждением
   - 0.2-0.4: Отраслевые источники, требует проверки
   - 0-0.1: Слухи, непроверенная информация

ИТОГОВАЯ ОЦЕНКА:
Неожиданность × 0.30 + Материальность × 0.25 + Скорость × 0.20 + Широта × 0.15 + Доверие × 0.10

РЕЗУЛЬТАТ: [ИТОГОВЫЙ БАЛЛ 0-1 с обоснованием каждого компонента]
'''